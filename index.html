<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Visualizador de Modelo 3D en AR con Controles</title>
    <!-- Incluye la biblioteca A-Frame y AR.js -->
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script src="https://cdn.rawgit.com/jeromeetienne/AR.js/2.0.8/aframe/build/aframe-ar.js"></script>
</head>
<body>
    <a-scene embedded arjs>
        <!-- Ajusta la escala del modelo para que sea m치s grande -->
        <a-entity gltf-model="#capo" scale="1 1 1"></a-entity>

        <!-- Modelo 3D GLB -->
        <a-assets>
            <a-asset-item id="capo" src="capo.glb"></a-asset-item>
        </a-assets>
        
        <!-- Configura la c치mara -->
        <a-entity id="camera" camera></a-entity>

        <!-- Controles de zoom y desplazamiento -->
        <a-entity id="controls" visible="false">
            <a-box position="-1.5 0 -2" rotation="0 45 0" color="green" scale="0.5 0.5 0.5" zoom-control></a-box>
            <a-box position="1.5 0 -2" rotation="0 -45 0" color="red" scale="0.5 0.5 0.5" zoom-control></a-box>
            <a-box position="0 0 -3" color="blue" scale="1 0.5 0.1" drag-control></a-box>
        </a-entity>
    </a-scene>

    <script>
        // A침ade un componente para controlar el zoom
        AFRAME.registerComponent('zoom-control', {
            init: function () {
                var el = this.el;
                var model = document.querySelector('[gltf-model="#capo"]');
                var initialScale = model.getAttribute('scale');
                var zoomSpeed = 0.05;

                el.addEventListener('click', function () {
                    model.setAttribute('scale', {
                        x: initialScale.x + zoomSpeed,
                        y: initialScale.y + zoomSpeed,
                        z: initialScale.z + zoomSpeed
                    });
                });
            }
        });

        // A침ade un componente para controlar el desplazamiento
        AFRAME.registerComponent('drag-control', {
            init: function () {
                var el = this.el;
                var isDragging = false;
                var previousPosition = { x: 0, y: 0 };

                el.addEventListener('mousedown', function (event) {
                    isDragging = true;
                    previousPosition.x = event.clientX;
                    previousPosition.y = event.clientY;
                });

                window.addEventListener('mousemove', function (event) {
                    if (!isDragging) return;

                    var deltaX = event.clientX - previousPosition.x;
                    var deltaY = event.clientY - previousPosition.y;

                    el.object3D.position.x += deltaX / 100;
                    el.object3D.position.y -= deltaY / 100;

                    previousPosition.x = event.clientX;
                    previousPosition.y = event.clientY;
                });

                window.addEventListener('mouseup', function () {
                    isDragging = false;
                });
            }
        });

        // Muestra/oculta los controles al tocar la pantalla
        document.querySelector('#camera').addEventListener('click', function () {
            var controls = document.querySelector('#controls');
            controls.setAttribute('visible', !controls.getAttribute('visible'));
        });
    </script>
</body>
</html>

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Visualizador de Modelo 3D en AR con Controles</title>
    <!-- Incluye la biblioteca A-Frame y AR.js -->
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script src="https://cdn.rawgit.com/jeromeetienne/AR.js/2.0.8/aframe/build/aframe-ar.js"></script>
</head>
<body>
    <a-scene embedded arjs>
        <!-- Configura la c치mara -->
        <a-entity camera look-controls></a-entity>

        <!-- A침ade el modelo 3D GLB -->
        <a-entity gltf-model="#capo" scale="1 1 1"></a-entity>

        <!-- Modelo 3D GLB -->
        <a-assets>
            <a-asset-item id="capo" src="capo.glb"></a-asset-item>
        </a-assets>

        <!-- Controles de zoom y desplazamiento -->
        <a-entity id="controls">
            <!-- Zoom In -->
            <a-box position="-1.5 0 -2" color="green" scale="0.5 0.5 0.1" zoom-control="direction: in"></a-box>
            <!-- Zoom Out -->
            <a-box position="1.5 0 -2" color="red" scale="0.5 0.5 0.1" zoom-control="direction: out"></a-box>
            <!-- Desplazamiento Izquierda -->
            <a-box position="-0.5 0 -3" color="blue" scale="0.1 0.5 0.1" drag-control="direction: left"></a-box>
            <!-- Desplazamiento Derecha -->
            <a-box position="0.5 0 -3" color="yellow" scale="0.1 0.5 0.1" drag-control="direction: right"></a-box>
        </a-entity>
    </a-scene>

    <script>
        // A침ade un componente para controlar el zoom y el desplazamiento
        AFRAME.registerComponent('zoom-control', {
            schema: {
                direction: { type: 'string', default: 'in' }
            },
            init: function () {
                var el = this.el;
                var model = document.querySelector('[gltf-model="#capo"]');
                var scaleIncrement = 0.1;

                el.addEventListener('click', function () {
                    var currentScale = model.getAttribute('scale');
                    var newScale;

                    if (this.data.direction === 'in') {
                        newScale = {
                            x: currentScale.x - scaleIncrement,
                            y: currentScale.y - scaleIncrement,
                            z: currentScale.z - scaleIncrement
                        };
                    } else if (this.data.direction === 'out') {
                        newScale = {
                            x: currentScale.x + scaleIncrement,
                            y: currentScale.y + scaleIncrement,
                            z: currentScale.z + scaleIncrement
                        };
                    }

                    model.setAttribute('scale', newScale);
                });
            }
        });

        // A침ade un componente para controlar el desplazamiento
        AFRAME.registerComponent('drag-control', {
            schema: {
                direction: { type: 'string', default: 'left' }
            },
            init: function () {
                var el = this.el;
                var isDragging = false;
                var previousPosition = { x: 0, y: 0 };

                el.addEventListener('mousedown', function (event) {
                    isDragging = true;
                    previousPosition.x = event.clientX;
                    previousPosition.y = event.clientY;
                });

                window.addEventListener('mousemove', function (event) {
                    if (!isDragging) return;

                    var deltaX = event.clientX - previousPosition.x;
                    var deltaY = event.clientY - previousPosition.y;

                    if (el.object3D) {
                        if (el.object3D.position) {
                            if (el.object3D.position.x && el.object3D.position.y) {
                                if (el.components) {
                                    var currentPosition = el.object3D.position;
                                    if (el.components.position) {
                                        if (el.components.position.data) {
                                            if (el.components.position.data.x) {
                                                if (el.components.position.data.y) {
                                                    var newPosition = {
                                                        x: currentPosition.x + (deltaX / 100),
                                                        y: currentPosition.y - (deltaY / 100),
                                                        z: currentPosition.z
                                                    };
                                                    el.setAttribute('position', newPosition);
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }

                    previousPosition.x = event.clientX;
                    previousPosition.y = event.clientY;
                });

                window.addEventListener('mouseup', function () {
                    isDragging = false;
                });
            }
        });
    </script>
</body>
</html>
